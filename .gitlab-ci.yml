smoke_runner_check:
  stage: smoke
  tags:
    - vps1
  when: manual
  allow_failure: true
  script:
    - echo "=== CI runner / job identity ==="
    - echo "CI_PROJECT_PATH: $CI_PROJECT_PATH"
    - echo "CI_COMMIT_REF_NAME: $CI_COMMIT_REF_NAME"
    - echo "CI_RUNNER_DESCRIPTION: $CI_RUNNER_DESCRIPTION"
    - echo "CI_RUNNER_TAGS: $CI_RUNNER_TAGS"

    - echo "=== Host info ==="
    - whoami
    - hostname
    - uname -a
    - date -u

    - echo "=== Network addresses (local) ==="
    - ip -4 addr show scope global || true

    - echo "=== Outbound source IP (no external call) ==="
    - ip route get 1.1.1.1 | awk '/src/ {print $NF}' || true

    - echo "=== Public IP (external lookup, optional) ==="
    - curl -sS --max-time 5 https://ifconfig.co || echo "external lookup failed"

    - echo "=== Tooling checks ==="
    - docker --version || echo "docker not found"
    - docker-compose version || docker compose version || echo "docker-compose not found"

    - echo "Smoke test finished"
